\section{Branch and Bound for Vertex Cover}

\begin{frame}{Necessity of Nemhauser-Trotter theorem}
  Nemhauser-Trotter theorem is essential for the correctness of the LP-based branch-and-bound algorithm because we can put all $S_1$ into the vertex cover immediately, not include all $S_0$, and only branch on $S_{1/2}$.

  % It guarantees that vertices assigned value 1 or 0 by the LP relaxation are respectively included in or excluded from at least one optimal vertex cover. This allows the algorithm to fix these vertices without branching while preserving optimality. Without this theorem, fixing variables based on LP values could remove all optimal solutions, making the algorithm incorrect.
\end{frame}


% Slide 3: The Theorem Statement
% \begin{frame}{The Nemhauser-Trotter Theorem}

%   Recall that if $x^*$ be an optimal solution to (LP), then there exists a vertex cover $S$ such that $S_1 \subset S \subset (S_1 \cup S_{1/2})$.





% \end{frame}

% % Slide 4: Algorithm Correctness
% \begin{frame}{Why the Theorem is Needed for Correctness}
%   Let us see the algorithm performs a \textbf{Reduction Step} before branching:

%   \begin{enumerate}
%     \item Solve LP.
%     \item If $LP(v_i) > 0.5$, \textbf{fix} $v_i = 1$ (In the cover).
%     \item If $LP(v_i) < 0.5$, \textbf{fix} $v_i = 0$ (Out of cover).
%     \item Solve the remaining subgraph induced by $S_{1/2}$.
%   \end{enumerate}

%   \begin{block}{Correctness:}
%     Without Nemhauser-Trotter Theorem, fixing $v=1$ because $LP(x)=0.9$ is just a guess, then it might be wrong.
%     \\ \vspace{0.2cm}
%     With Nemhauser-Trotter Theorem,
%     we have a guarantee that we are not discarding the optimal solution. The reduction is \textbf{safe} and \textbf{exact}.
%   \end{block}
% \end{frame}


\begin{frame}{General Algorithm}

  \begin{enumerate}
    \item Maintain the current cost and the current best solution.
    \item Extract $S_0, S_1$ and $S_{1/2}$ from an extreme solution of (LP).
    \item If adding $S_1$ exceeds the current best solution, stop (prune this branch).
    \item If $S_{1/2}$ is empty, update the current best solution if necessary and stop.
    \item Choose a vertex $v \in S_{1/2}$.
    \item Return to step 2 two following graphs in some order:
          \begin{itemize}
            \item Graph with $v$ included in the vertex cover (remove $v$ and its incident edges).
            \item Graph with $v$ excluded from the vertex cover (remove $v$'s neighbors and their incident edges, add $v$ to the current cost).
          \end{itemize}
  \end{enumerate}

  Different strategies for steps 5 and 6 lead to different algorithms.

However, BnB can be shown to suffer from $O(2^{|V|})$ for some instances \footnote{Dey, Santanu S., et al. "A theoretical and computational analysis of full strong-branching." Mathematical Programming 205.1 (2024): 303-336.}
\end{frame}

\begin{frame}{Experiments}
  We consider three strategies \footnote{Implementation is on \href{https://github.com/mintcd/discrete-optimization-project}{https://github.com/mintcd/discrete-optimization-project}}
  \begin{itemize}
    \item Choosing the vertex with the highest degree in $S_{1/2}$ and include it first.
    \item Choosing the vertex with the lowest degree in $S_{1/2}$ and exclude it first.
    \item Fully-strong branching \footnote{BÃ©nichou, Michel, et al. "Experiments in mixed-integer linear programming." Mathematical programming 1.1 (1971): 76-94.}: choose the vertex and the order whose resulting LP relaxation has the highest total value.
  \end{itemize}
\end{frame}

\begin{frame}{Results - Strategy 1: Highest Degree Include First}
  \small
  \begin{table}
    \centering
    \begin{tabular}{lrrrrrr}
      \hline
      Instance           & $|V|$ & $|E|$ & Opt VC & BnB Nodes              & LP Calls               & Time (s) \\
      \hline
      johnson8-2-4       & 28    & 210   & 21     & 31                     & 31                     & 0.22     \\
      MANN-a9            & 45    & 918   & 42     & 79                     & 57                     & 0.64     \\
      hamming6-2         & 64    & 1824  & 62     & 265                    & 189                    & 1.92     \\
      johnson8-4-4       & 70    & 1855  & 65     & 323                    & 276                    & 2.64     \\
      johnson16-2-4      & 120   & 5460  & 105    & 183                    & 183                    & 8.87     \\
      C125-9             & 125   & 6963  & 121    & 487                    & 364                    & 11.31    \\
      eco-foodweb-baywet & 128   & 2075  & 86     & 91                     & 89                     & 2.24     \\
      keller4            & 171   & 9435  & 156    & 2849                   & 2835                   & 47.41    \\
      brock200-1         & 200   & 14834 & 194    & 6723                   & 6701                   & 92.82    \\
      bn-macaque         & 242   & 3054  & 150    & 1851                   & 1851                   & 48.13    \\
      inf-USAir97        & 332   & 2126  & 149    & 791                    & 775                    & 6.37     \\
      delaunay\_n10      & 1024  & 3056  & 717*   & 96158                  & 88318                  & 600.04   \\
      inf-euroroad       & 1174  & 1417  & 571*   & 66220                  & 64256                  & 600.01   \\
      econ-mahindas      & 1258  & 7619  & 730*   & 8270                   & 8219                   & 600.12   \\
      mk11-b2            & 6930  & 20779 & 909    & \textcolor{gustave}{1} & \textcolor{gustave}{1} & 1.21     \\
      \hline
    \end{tabular}
  \end{table}
  \vspace{-0.2cm}
  {\footnotesize * indicates timeout (10 min limit)}
\end{frame}

\begin{frame}{Results - Strategy 2: Excluding Min Degree}
  \small
  \begin{table}
    \centering
    \begin{tabular}{lrrrrrr}
      \hline
      Instance                    & $|V|$ & $|E|$ & Opt\_VC & Nodes                    & LP Calls & Time (s) \\
      \hline
      johnson8-2-4                & 28    & 210   & 21      & \textcolor{gustave}{29}  & 29       & 0.19     \\
      MANN-a9                     & 45    & 918   & 42      & 115                      & 67       & 0.71     \\
      hamming6-2                  & 64    & 1824  & 62.0    & 377                      & 221      & 2.06     \\
      johnson8-4-4                & 70    & 1855  & 65      & 441                      & 441      & 3.40     \\
      johnson16-2-4               & 120   & 5460  & 105     & \textcolor{gustave}{181} & 181      & 8.94     \\
      C125-9.vc                   & 125   & 6963  & 121.0   & 909                      & 635      & 14.12    \\
      eco-foodweb-baywet          & 128   & 2075  & 86*     & 32599                    & 32599    & 600.02   \\
      keller4                     & 171   & 9435  & 156     & 12489                    & 12489    & 200.11   \\
      brock200-1                  & 200   & 14834 & 194.0   & 16905                    & 15581    & 199.32   \\
      bn-macaque-rhesus\_brain\_1 & 242   & 3054  & 150.0*  & 38685                    & 38685    & 600.01   \\
      inf-USAir97.vc              & 332   & 2126  & 149*    & 110982                   & 109418   & 600.00   \\
      mk11-b2                     & 6930  & 20779 & 909     & 1                        & 1        & 0.90     \\
      \hline
    \end{tabular}
  \end{table}
  \vspace{-0.2cm}
  {\footnotesize * indicates timeout (10 min limit)}
\end{frame}


\begin{frame}{Results - Strategy 3: Strong full branching}
  \small
  \begin{table}
    \centering
    \begin{tabular}{lrrrrrr}
      \hline
      Instance           & $|V|$ & $|E|$ & Opt\_VC & Nodes & LP Calls & Time (s) \\
      \hline
      johnson8-2-4       & 28    & 210   & 21.0    & 31    & 676      & 4.73     \\
      MANN-a9            & 45    & 918   & 42.0    & 81    & 1335     & 18.11    \\
      hamming6-2         & 64    & 1824  & 62.0    & 273   & 4735     & 68.46    \\
      johnson8-4-4       & 70    & 1855  & 65.0    & 363   & 7796     & 96.52    \\
      johnson16-2-4      & 120   & 5460  & 105.0   & 183   & 13924    & 562.39   \\
      C125-9             & 125   & 6963  & 121.0   & 487   & 2453     & 68.16    \\
      eco-foodweb-baywet & 128   & 2075  & 94.0*   & 299   & 25969    & 600.01   \\
      inf-USAir97        & 332   & 2126  & 150.0*  & 1162  & 62353    & 600.41   \\
      mk11-b2            & 6930  & 20779 & 909.0   & 1     & 1        & 0.47     \\
      \hline
    \end{tabular}
  \end{table}
  \vspace{-0.2cm}
  {\footnotesize * indicates timeout (10 min limit)}
\end{frame}


\begin{frame}{Discussion}
  Looking at the CSV data, considering \texttt{BnB\_nodes} vs \texttt{LP\_calls} :

  \begin{itemize}
    \item \textbf{Case A: Fast Solving (e.g., Johnson graphs, mk11-b2)}
          \begin{itemize}
            \item The LP likely returned many values $\neq 0.5$.
            \item Nemhauser-Trotter Theorem allowed the algorithm to fix these variables immediately.
            \item Result: The graph size reduced drastically $\to$ few Branch-and-Bound nodes.
          \end{itemize}

    \item \textbf{Case B: Time Limit Exceed (e.g., delaunay\_n10)}
          \begin{itemize}
            \item The LP likely returned many values \textbf{exactly equal to 0.5}.
            \item Nemhauser-Trotter provides \textbf{no information} for $0.5$ values.
            \item Result: The algorithm cannot reduce the graph and must Branch on everything $\to$ Exponential explosion.
          \end{itemize}
  \end{itemize}
\end{frame}


